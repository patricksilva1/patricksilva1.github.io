<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Study</title>
  <style>
    :root{--bg:#0b0b0b;--card:#0f0f0f;--muted:#9a9a9a}
    body{font-family:Arial,Helvetica,sans-serif;background:var(--bg);color:#eaeaea;margin:0;padding:24px}
    .wrap{max-width:980px;margin:0 auto}
    header{display:flex;align-items:center;justify-content:space-between}
    h1{font-size:20px;margin:0}
    p{color:var(--muted);margin:6px 0 18px}
    .card{background:var(--card);border:1px solid #222;border-radius:10px;padding:14px}
    ul{list-style:none;padding:0;margin:0}
    li{padding:10px;border-bottom:1px solid #161616;display:flex;justify-content:space-between;align-items:center}
    .name{flex:1;padding-right:12px;cursor:pointer}
    .name:hover{text-decoration:underline;}
    #status{margin-bottom:12px;}
    #fileList{margin-top:18px;}
    .pagination{display:flex;justify-content:center;align-items:center;margin:18px 0;flex-wrap:wrap;}
    .pagination button{background:#222;color:#eaeaea;border:none;padding:6px 12px;margin:0 2px 4px 2px;border-radius:4px;cursor:pointer;}
    .pagination button[disabled]{opacity:0.4;cursor:not-allowed;}
    .pagination .page-info{margin:0 10px;color:var(--muted);}
    .pagination .page-btn.active{background:#444;color:#fff;font-weight:bold;}
    .search-box{margin-bottom:12px;}
    .search-input{padding:6px 10px;border-radius:4px;border:1px solid #333;background:#181818;color:#eaeaea;width:100%;max-width:320px;}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Study</h1>
    </header>
    <div id="status"></div>
    <div class="card">
      <div class="search-box">
        <input id="searchInput" class="search-input" type="text" placeholder="Buscar por nome do PDF..." autocomplete="off">
      </div>
      <ul id="fileList"></ul>
      <div class="pagination" id="pagination"></div>
    </div>
  </div>

  <script src="files.js"></script>
  <script>  
    const PAGE_SIZE = 15;
    let currentPage = 1;
    let filteredFiles = files || [];

    function showStatus(msg, warn = false) {
      const s = document.getElementById('status');
      s.textContent = msg;
      s.style.color = warn ? '#f6b' : '#8f8';
    }

    function renderList(files, page = 1) {
      const list = document.getElementById('fileList');
      list.innerHTML = '';
      const start = (page - 1) * PAGE_SIZE;
      const end = start + PAGE_SIZE;
      const pageFiles = files.slice(start, end);

      if (pageFiles.length === 0) {
        const li = document.createElement('li');
        li.textContent = 'Nenhum arquivo encontrado.';
        list.appendChild(li);
      }

      pageFiles.forEach(file => {
        const li = document.createElement('li');
        const name = document.createElement('span');
        name.className = 'name';
        let displayName = file.name.split('/').pop().replace(/\.pdf$/i, '');
        name.textContent = displayName;
        name.title = file.name;
        name.onclick = () => {
          window.open(file.path, '_blank');
        };
        li.appendChild(name);
        list.appendChild(li);
      });

      renderPagination(files.length, page);
    }

    function renderPagination(total, page) {
      const totalPages = Math.max(1, Math.ceil(total / PAGE_SIZE));
      const pag = document.getElementById('pagination');
      pag.innerHTML = '';

      if (totalPages <= 1) return;

      // Botão "Primeira"
      const first = document.createElement('button');
      first.textContent = '«';
      first.disabled = page === 1;
      first.title = 'Primeira página';
      first.onclick = () => {
        currentPage = 1;
        renderList(filteredFiles, currentPage);
      };
      pag.appendChild(first);

      // Botão "Anterior"
      const prev = document.createElement('button');
      prev.textContent = '‹';
      prev.disabled = page === 1;
      prev.title = 'Página anterior';
      prev.onclick = () => {
        currentPage--;
        renderList(filteredFiles, currentPage);
      };
      pag.appendChild(prev);

      // Números de página (máximo 7)
      let startPage = Math.max(1, page - 3);
      let endPage = Math.min(totalPages, page + 3);
      if (page <= 4) endPage = Math.min(7, totalPages);
      if (page > totalPages - 4) startPage = Math.max(1, totalPages - 6);

      for (let i = startPage; i <= endPage; i++) {
        const btn = document.createElement('button');
        btn.textContent = i;
        btn.className = 'page-btn' + (i === page ? ' active' : '');
        btn.disabled = i === page;
        btn.onclick = () => {
          currentPage = i;
          renderList(filteredFiles, currentPage);
        };
        pag.appendChild(btn);
      }

      // Botão "Próxima"
      const next = document.createElement('button');
      next.textContent = '›';
      next.disabled = page === totalPages;
      next.title = 'Próxima página';
      next.onclick = () => {
        currentPage++;
        renderList(filteredFiles, currentPage);
      };
      pag.appendChild(next);

      // Botão "Última"
      const last = document.createElement('button');
      last.textContent = '»';
      last.disabled = page === totalPages;
      last.title = 'Última página';
      last.onclick = () => {
        currentPage = totalPages;
        renderList(filteredFiles, currentPage);
      };
      pag.appendChild(last);

      // Info de página
      const pageInfo = document.createElement('span');
      pageInfo.className = 'page-info';
      pageInfo.textContent = `Página ${page} de ${totalPages}`;
      pag.appendChild(pageInfo);
    }

    function filterFiles(query) {
      if (!query) return files;
      query = query.toLowerCase();
      return files.filter(f => f.name.toLowerCase().includes(query));
    }

    function load() {
      if (!files || files.length === 0) {
        showStatus('Nenhum arquivo encontrado.', true);
        return;
      }
      showStatus('Lista carregada.');
      renderList(filteredFiles, currentPage);
    }

    document.getElementById('searchInput').addEventListener('input', function(e) {
      const query = e.target.value;
      filteredFiles = filterFiles(query);
      currentPage = 1;
      renderList(filteredFiles, currentPage);
    });

    load();
  </script>
</body>
</html>
